<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Splitwise-like Web App</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 800px;
            margin: 20px auto;
            background: #fff;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
        }

        h1 {
            text-align: center;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
        }

        input, select, button {
            width: 100%;
            padding: 8px;
            box-sizing: border-box;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        .participants-list {
            margin-top: 10px;
            padding-left: 15px;
        }

        .summary {
            margin-top: 20px;
            background: #f9f9f9;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #ccc;
        }

        .settlement {
            font-weight: bold;
            color: #2c7;
        }

        button {
            background-color: #28a745;
            color: white;
            font-weight: bold;
            cursor: pointer;
        }

        button:hover {
            background-color: #218838;
        }
    </style>
    <script>
        let participants = [];
        let expenses = [];

        function addParticipant() {
            const name = document.getElementById('participant-name').value.trim();
            if (name && !participants.includes(name)) {
                participants.push(name);
                updateParticipantsList();
            }
            document.getElementById('participant-name').value = '';
        }

        function updateParticipantsList() {
            const list = document.getElementById('participants-list');
            list.innerHTML = participants.map(p => `<li>${p}</li>`).join('');
        }

        function addExpense() {
            const description = document.getElementById('expense-description').value;
            const amount = parseFloat(document.getElementById('expense-amount').value);
            const paidBy = document.getElementById('paid-by').value;
            const splitMethod = document.getElementById('split-method').value;
            const currency = document.getElementById('currency').value;

            let splitAmounts = [];
            if (splitMethod === 'equally') {
                const equalAmount = (amount / participants.length).toFixed(2);
                splitAmounts = participants.map(() => parseFloat(equalAmount));
            } else {
                const manualAmounts = participants.map((p, index) => {
                    const input = document.getElementById(`manual-input-${index}`).value;
                    return parseFloat(input) || 0;
                });

                const totalManual = manualAmounts.reduce((sum, val) => sum + val, 0);
                if (totalManual !== amount) {
                    manualAmounts[manualAmounts.length - 1] += (amount - totalManual);
                }
                splitAmounts = manualAmounts;
            }

            expenses.push({
                description,
                amount,
                paidBy,
                splitAmounts,
                currency
            });

            updateExpensesList();
            resetExpenseForm();
        }

        function updateExpensesList() {
            const list = document.getElementById('expenses-list');
            list.innerHTML = expenses.map((e, index) => `
                <li>
                    ${e.description} - ${e.amount} ${e.currency}, Paid by: ${e.paidBy}, Split: ${e.splitAmounts.join(', ')}
                </li>
            `).join('');
        }

        function resetExpenseForm() {
            document.getElementById('expense-description').value = '';
            document.getElementById('expense-amount').value = '';
            document.getElementById('paid-by').value = participants[0];
            document.getElementById('split-method').value = 'equally';
        }

        function updateSplitMethod() {
            const splitMethod = document.getElementById('split-method').value;
            const manualSplitDiv = document.getElementById('manual-split');
            if (splitMethod === 'manual') {
                manualSplitDiv.innerHTML = participants.map((p, index) => `
                    <label>${p}</label>
                    <input type="number" id="manual-input-${index}" placeholder="Amount for ${p}">
                `).join('');
            } else {
                manualSplitDiv.innerHTML = '';
            }
        }

        function calculateSettlement() {
            const balances = {};
            participants.forEach(p => balances[p] = 0);

            expenses.forEach(e => {
                e.splitAmounts.forEach((amount, index) => {
                    balances[participants[index]] -= amount;
                });
                balances[e.paidBy] += e.amount;
            });

            const settlements = [];
            const creditors = Object.entries(balances).filter(([_, balance]) => balance > 0);
            const debtors = Object.entries(balances).filter(([_, balance]) => balance < 0);

            while (creditors.length && debtors.length) {
                const [creditor, creditAmount] = creditors.pop();
                const [debtor, debtAmount] = debtors.pop();
                const settlementAmount = Math.min(creditAmount, -debtAmount);

                settlements.push(`${debtor} pays ${creditor} ${settlementAmount.toFixed(2)}`);

                if (creditAmount > settlementAmount) {
                    creditors.push([creditor, creditAmount - settlementAmount]);
                }

                if (-debtAmount > settlementAmount) {
                    debtors.push([debtor, debtAmount + settlementAmount]);
                }
            }

            document.getElementById('settlement-summary').innerText = settlements.join('\n');
        }

    </script>
</head>
<body>
    <div class="container">
        <h1>Splitwise-like App</h1>

        <div class="form-group">
            <label for="participant-name">Add Participant:</label>
            <input type="text" id="participant-name" placeholder="Enter participant name">
            <button onclick="addParticipant()">Add</button>
        </div>

        <ul class="participants-list" id="participants-list"></ul>

        <div class="form-group">
            <label for="expense-description">Expense Description:</label>
            <input type="text" id="expense-description" placeholder="Enter expense description">
        </div>

        <div class="form-group">
            <label for="expense-amount">Amount:</label>
            <input type="number" id="expense-amount" placeholder="Enter amount">
        </div>

        <div class="form-group">
            <label for="currency">Currency:</label>
            <select id="currency">
                <option value="GBP">GBP £</option>
                <option value="EUR">EUR €</option>
                <option value="HKD">HKD $</option>
            </select>
        </div>

        <div class="form-group">
            <label for="paid-by">Paid By:</label>
            <select id="paid-by"></select>
        </div>

        <div class="form-group">
            <label for="split-method">Split Method:</label>
            <select id="split-method" onchange="updateSplitMethod()">
                <option value="equally">Split Equally</option>
                <option value="manual">Manual Input</option>
            </select>
        </div>

        <div id="manual-split"></div>

        <button onclick="addExpense()">Add Expense</button>

        <ul id="expenses-list" class="summary"></ul>

        <button onclick="calculateSettlement()">Calculate Settlement</button>

        <div id="settlement-summary
